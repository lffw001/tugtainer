<p-confirmpopup></p-confirmpopup>

<form
  [formGroup]="form"
  class="hosts-form"
  (submit)="save()"
>
  <p-accordion
    [value]="accordionValue()"
    (valueChange)="accordionValue.set($event)"
    [multiple]="true"
  >
    <p-accordion-panel value="help">
      <p-accordion-header>
        {{ 'HOSTS.CARD.HELP.LABEL' | translate }}
      </p-accordion-header>
      <p-accordion-content>
        <section class="accordion-content">
          @for (t of 'HOSTS.CARD.HELP.TEXT' | translate; track t) {
            <div>{{ t }}</div>
          }
          <p-button
            icon="pi pi-link"
            severity="success"
            [label]="'HOSTS.CARD.HELP.HELP_BTN' | translate"
            (onClick)="openHelp()"
          ></p-button>
        </section>
      </p-accordion-content>
    </p-accordion-panel>

    <p-accordion-panel value="main">
      <p-accordion-header>
        {{ 'HOSTS.CARD.GENERAL.LABEL' | translate }}
      </p-accordion-header>
      <p-accordion-content>
        <section class="accordion-content">
          <span
            class="switch-field"
            fluid
          >
            <p-toggle-switch
              [inputId]="'host-enabled'"
              formControlName="enabled"
            ></p-toggle-switch>
            <label for="host-enabled">
              {{ 'HOSTS.CARD.GENERAL.ENABLED' | translate }}
            </label>
          </span>

          <span
            class="switch-field"
            fluid
          >
            <p-toggle-switch
              [inputId]="'host-prune'"
              formControlName="prune"
            ></p-toggle-switch>
            <label for="host-prune">
              {{ 'HOSTS.CARD.GENERAL.PRUNE' | translate }}
              <i
                class="pi pi-question-circle"
                style="margin: 0 0.5rem"
                [pTooltip]="'HOSTS.CARD.GENERAL.PRUNE_HINT' | translate"
                tooltipPosition="left"
              ></i>
            </label>

            <p-toggle-switch
              [inputId]="'host-prune-all'"
              formControlName="prune_all"
            ></p-toggle-switch>
            <label for="host-prune-all">
              {{ 'HOSTS.CARD.GENERAL.PRUNE_ALL' | translate }}
              <i
                class="pi pi-question-circle"
                style="margin: 0 0.5rem"
                [pTooltip]="'HOSTS.CARD.GENERAL.PRUNE_ALL_HINT' | translate"
                tooltipPosition="left"
              ></i>
            </label>
          </span>

          <p-iftaLabel fluid>
            <input
              fluid
              pInputText
              id="host-name"
              formControlName="name"
            />
            <label for="host-name">
              {{ 'HOSTS.CARD.GENERAL.NAME' | translate }}
            </label>
          </p-iftaLabel>

          <p-iftaLabel fluid>
            <input
              fluid
              pInputText
              id="host-url"
              formControlName="url"
              [placeholder]="'HOSTS.CARD.GENERAL.URL_PLACEHOLDER' | translate"
            />
            <label for="host-url">
              {{ 'HOSTS.CARD.GENERAL.URL' | translate }}
            </label>
          </p-iftaLabel>

          <p-iftaLabel fluid>
            <p-password
              fluid
              [inputId]="'host-secret'"
              autocomplete="agent-secret"
              formControlName="secret"
              [toggleMask]="true"
              [feedback]="false"
            >
            </p-password>
            <label for="host-secret">
              {{ 'HOSTS.CARD.GENERAL.SECRET' | translate }}
            </label>
          </p-iftaLabel>

          <p-iftaLabel fluid>
            <p-iconfield>
              <p-input-number
                fluid
                inputId="host-timeout"
                formControlName="timeout"
              >
              </p-input-number>
              <p-inputicon
                class="pi pi-question-circle"
                [pTooltip]="'HOSTS.CARD.GENERAL.TIMEOUT_HINT' | translate"
              ></p-inputicon>
            </p-iconfield>
            <label for="host-timeout">
              {{ 'HOSTS.CARD.GENERAL.TIMEOUT' | translate }}
            </label>
          </p-iftaLabel>

          <p-iftaLabel fluid>
            <p-iconfield>
              <p-input-number
                fluid
                inputId="host-cont-hc-timeout"
                formControlName="container_hc_timeout"
              >
              </p-input-number>
              <p-inputicon
                class="pi pi-question-circle"
                [pTooltip]="'HOSTS.CARD.GENERAL.CONTAINER_HC_TIMEOUT_HINT' | translate"
              ></p-inputicon>
            </p-iconfield>
            <label for="host-cont-hc-timeout">
              {{ 'HOSTS.CARD.GENERAL.CONTAINER_HC_TIMEOUT' | translate }}
            </label>
          </p-iftaLabel>
        </section>
      </p-accordion-content>
    </p-accordion-panel>
  </p-accordion>

  <section class="buttons">
    <p-button-group>
      <p-button
        [label]="'GENERAL.GO_BACK' | translate"
        routerLink="/hosts"
        severity="secondary"
        icon="pi pi-arrow-left"
      ></p-button>
      <p-button
        type="submit"
        [label]="saveTitle()"
        [loading]="isLoading()"
        severity="success"
        [disabled]="!form.dirty"
        icon="pi pi-save"
      ></p-button>
    </p-button-group>

    @if (id()) {
      <p-button
        icon="pi pi-trash"
        severity="danger"
        [label]="'GENERAL.DELETE' | translate"
        (onClick)="confirmDelete($event)"
      ></p-button>
    }
  </section>
</form>
